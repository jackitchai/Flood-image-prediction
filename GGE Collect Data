import ee
# Trigger the authentication flow.
ee.Authenticate()

# Initialize the library.
ee.Initialize()
##############

import time
province = "Ubon"
geometry = ee.Geometry.Polygon(
        [[[104.64912571711469, 15.33036097900656],
          [104.64912571711469, 15.098458530820098],
          [105.11879124445844, 15.098458530820098],
          [105.11879124445844, 15.33036097900656]]])

# province = "NakhonSawan"
# [100.54565834145852,15.563170873987385]
# [100.54565834145852,15.967588992623856]
# [100.04028724770852,15.967588992623856]
# [100.04028724770852,15.563170873987385]
# geometry = ee.Geometry.Polygon(
#     [[[100.54565834145852,15.563170873987385],
#          [100.54565834145852,15.967588992623856],
#           [100.04028724770852,15.967588992623856],
#          [100.04028724770852,15.563170873987385]]])
# province = "Phranakorn"
#  [100.67929554994997,14.17875724009257]
#  [100.67929554994997,14.46882760875456]
#  [100.2741747003406,14.46882760875456]
#  [100.2741747003406,14.17875724009257]
# geometry = ee.Geometry.Polygon(
#     [[[100.67929554994997,14.17875724009257],
#           [100.67929554994997,14.46882760875456],
#           [100.2741747003406,14.46882760875456],
#           [100.2741747003406,14.17875724009257]]])
province = "Metropolitan"
# [100.93579578336589,13.508959177449169]
# [100.93579578336589,14.159680576695507]
# [99.87012195524089,14.159680576695507]
# [99.87012195524089,13.508959177449169]
geometry = ee.Geometry.Polygon(
     [[[100.93579578336589,13.508959177449169],
          [100.93579578336589,14.159680576695507],
           [99.87012195524089,14.159680576695507],
           [99.87012195524089,13.508959177449169]]])

# province = "Norththai"
#  [100.80677642033183,16.177617121238548]
#  [100.80677642033183,19.419844124272537]
#  [98.69740142033183,19.419844124272537]
#  [98.69740142033183,16.177617121238548]
# geometry = ee.Geometry.Polygon(
#      [[[100.80677642033183,16.177617121238548],
#           [100.80677642033183,19.419844124272537],
#            [98.69740142033183,19.419844124272537],
#            [98.69740142033183,16.177617121238548]]])
# province = "Souththai"
# 1: [100.34117759885869,8.000583279522388]
# 2: [100.34117759885869,8.826550663894844]
# 3: [99.37850059690557,8.826550663894844]
# 4: [99.37850059690557,8.000583279522388]
# geometry = ee.Geometry.Polygon(
#      [[[100.34117759885869,8.000583279522388],
#          [100.34117759885869,8.826550663894844],
#            [99.37850059690557,8.826550663894844],
#            [99.37850059690557,8.000583279522388]]])


#######


### range = 1 ไม่ใช่ = 7
for year in range (2017,2018) :
  for month in range(1,13):
    for day in range (1,32): 
      print(str(year)+"_"+str(month)+"_"+str(day))
      myimage = ee.Image(ee.ImageCollection('COPERNICUS/S1_GRD') 
                            .filterBounds(geometry) 
                            .filterDate(ee.Date(str(year)+"-"+str(month)+"-"+str(day)), ee.Date(str(year)+"-"+str(month)+'-'+str(day+1))) 
                            .mosaic() 
                            .select('VV')
                            .clip(geometry))
      print('load image complete')
      task = ee.batch.Export.image.toDrive(image=myimage,
                                          description=str(year)+"_"+str(month)+"_"+str(day),
                                          region=geometry,
                                          folder=province+"_"+str(year),
                                          scale=100, #ยิ่งน้อยยิ่งละเอียด 100 ตารางเมตรต่อ 1 pixel
                                          crs='EPSG:3857')
        
      task.start()
      a = 1  
      while task.active():
          if a ==1 :
              print('Waiting on (id: {}).'.format(task.id))
              a+=1
